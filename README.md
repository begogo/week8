# week8 DB 학습

## DB와 DBMS
- 여러 사람에 의해 공유되어 사용될 목적으로 통합하여 관리되는 데이터의 집합
- 자료항목의 중복을 없애고 자료를 구조화하여 저장함으로써 자료 검색과 갱신의 효율 상승
- DBMS: Database Management System, 즉 다수의 사용자들이 데이터베이스 내의 데이터에게 접근, 사용할 수 있도록 해주는 소프트웨어

## RDB와 RDBMS
- 관계형 데이터 모델에 기초를 둔 데이터베이스
- 관계형 데이터 모델이란 데이터를 구성하는데 필요한 방법 중 하나로 모든 데이터를 2차원의 테이블 형태로 표현
- 데이터의 독립성이 높고, 고수준의 데이터 조작언어(DML-Data Manipulation Language)을 사용하여 결합, 제약, 투영 등의 관계 조작에 의해 비약적으로 표현능력을 높일 수 있고, 자유롭게 구조를 변경할 수 있음
- RDBMS: 관계형 데이터베이스를 생성하고 수정하고 관리할 수 있는 소프트웨어

## RDBMS의 종류
- ORACLE, MYSQL, MariaDB, MS SQL SERVER 등

## 데이터베이스 언어

- **데이터베이스 언어란?** 

1. 데이터베이스 언어(Database Language)는 데이터베이스를 구축하고 이용하기 위한 데이터베이스 시스템과의 통신 수단이다.

2. 데이터베이스 언어는 DBMS를 통해 사용되며, 기능과 사용 목적에 따라 데이터 정의 언어, 데이터 조작 언어, 데이터 제어 언어로 구분된다.


### DDL

- **데이터 정의 언어(DDL)**

1. 데이터 정의 언어(DDL)는 DB구조, 데이터 형식, 접근 방식 등 DB를 구축하거나 수정할 목적으로 사용하는 언어이다.

2. 데이터 정의 언어는 번역한 결과가 데이터 사전(DataDictionary)이라는 특별한 파일에 여러개의 테이블로서 저장된다.

3. CREATE, DROP, ALTER...


- **데이터 정의 언어(DDL)의 기능**

1. 외부 스키마 명세를 정의한다.

2. 데이터베이스의 논리적, 물리적 구조 및 구조 간의 사상을 정의한다.

3. 스키마에 사용되는 제약 조건에 대한 명세를 정의한다.

4. 데이터의 물리적 순서를 규정한다.


### DML

- **데이터 조작 언어(DML)** 

1. 데이터 조작 언어(DML)는 사용자로 하여금 데이터를 처리할 수 있게 하는 도구로서, 사용자(응용 프로그램)와 DBMS 간의 인터페이스를 제공한다.

2. 응용프로그램을 통하여 사용자가 DB의 데이터를 실질적으로 조작할 수 있도록 하기 위해 다양한 언어에 DB기능을 추가해서 만든 언어이다.

3. 대표적인 데이터 조작 언어(DML)에는 질의어가 있으며, 질의어는 터미널에서 주로 이용하는 비절차적(Non Procedural)데이터 언어이다.

4. INSERT, SELECT, UPDATE, DELETE 

*※ 질의어란 : 단말 사용자가 쉽게 DB를 액세스할 수 있도록 대화식의 자연어로 만든 비절차적 조작언어이다. 독자적이고 상호 작용 형태로 터미널에서 많이 사용하는 고급 명령어 형태의 독립된 데이터 조작언어이다.*


- **데이터 조작 언어의 조건**

1. 사용하기 쉽고 자연언어에 가까워야한다.

2. 데이터에 대한 연산뿐만 아니라 뷰 내의 데이터나 데이터 간의 관계를 정확하고 완전하게 명시할 수 있어야 한다.

3. 데이터 언어의 효율적인 구현을 지원해야 한다. 즉 데이터 언어의 구문이 DBMS가 제공하는 기본적인 연산과 관련을 갖도록 해야 한다.


### DCL

- **데이터 제어 언어(DCL)**

1. 데이터 제어 언어(DCL)는 무결성, 보안 및 권한 제어 회복 등을 하기 위한 언어이다.

2. 데이터 제어 언어(DCL)는 데이터를 보호하고 데이터를 관리하는 목적으로 사용된다.


- **데이터 제어 언어의 기능**

1. 불법적인 사용자로부터 데이터를 보호하기 위한 데이터 보안(Security)

2. 데이터 정확성을 위한 무결성(Integrity)유지

3. 시스템 장애에 대비한 회복과 병행수행 제어


## 트랜잭션


- **트랜잭션의 정의**  

  트랜잭션(Transaction)은 데이터베이스의 상태를 변환시키는 하나의 논리적 기능을 수행하기 위한 작업의 단위 또는 한꺼번에 모두 수행되어야 할 일련의 연산들을 의미한다.



- **트랜잭션의 특징**
1. 트랜잭션은 데이터베이스 시스템에서 병행 제어 및 회복 작업 시 처리되는 작업의 논리적 단위이다.
2. 사용자가 시스템에 대한 서비스 요구 시 시스템이 응답하기 위한 상태 변환 과정의 작업단위이다.
3. 하나의 트랜잭션은 Commit되거나 Rollback된다.



- **트랜잭션의 성질** 

**Atomicity(원자성)**
1. 트랜잭션의 연산은 데이터베이스에 모두 반영되든지 아니면 전혀 반영되지 않아야 한다.
2. 트랜잭션 내의 모든 명령은 반드시 완벽히 수행되어야 하며, 모두가 완벽히 수행되지 않고 어느하나라도 오류가 발생하면 트랜잭션 전부가 취소되어야 한다.


**Consistency(일관성)**
1. 트랜잭션이 그 실행을 성공적으로 완료하면 언제나 일관성 있는 데이터베이스 상태로 변환한다.
2. 시스템이 가지고 있는 고정요소는 트랜잭션 수행 전과 트랜잭션 수행 완료 후의 상태가 같아야 한다.


**Isolation(독립성,격리성)**
1. 둘 이상의 트랜잭션이 동시에 병행 실행되는 경우 어느 하나의 트랜잭션 실행중에 다른 트랜잭션의 연산이 끼어들 수 없다.
2. 수행중인 트랜잭션은 완전히 완료될 때까지 다른 트랜잭션에서 수행 결과를 참조할 수 없다.


**Durablility(영속성,지속성)**
1. 성공적으로 완료된 트랜잭션의 결과는 시스템이 고장나더라도 영구적으로 반영되어야 한다.



- **트랜잭션의 연산** 

Commit연산
1. Commit 연산은 한개의 논리적 단위(트랜잭션)에 대한 작업이 성공적으로 끝났고 데이터베이스가 다시 일관된 상태에 있을 때, 이 트랜2. 잭션이 행한 갱신 연산이 완료된 것을 트랜잭션 관리자에게 알려주는 연산이다.


Rollback연산
1. Rollback 연산은 하나의 트랜잭션 처리가 비정상적으로 종료되어 데이터베이스의 일관성을 깨뜨렸을 때, 이 트랜잭션의 일부가 정상적으로 처리되었더라도 트랜잭션의 원자성을 구현하기 위해 이 트랜잭션이 행한 모든 연산을 취소(Undo)하는 연산이다.
2. Rollback시에는 해당 트랜잭션을 재시작하거나 폐기한다.



- **트랜잭션의 상태**

  활동(Active) : 트랜잭션이 실행중인 상태

  실패(Failed) : 트랜잭션 실행에 오류가 발생하여 중단된 상태

  철회(Aborted) : 트랜잭션이 비정상적으로 종료되어 Rollback 연산을 수행한 상태

  부분 완료(Partially Committed) : 트랜잭션의 마지막 연산까지 실행했지만, Commit 연산이 실행되기 직전의 상태

  완료(Committed) : 트랜잭션이 성공적으로 종료되어 Commit 연산을 실행한 후의 상태



---------------------------------------

MYSQL 실습 (버전 7.4.19, CLI 사용)

    mysql -uroot -p
    (password 입력)
    
    CREATE DATABASE week8;
    SHOW DATABASES;
    USE week8;
    
    CREATE TABLE post(
    id INT(11) NOT NULL AUTO_INCREMENT,
    title VARCHAR(100) NOT NULL,
    description TEXT NOT NULL,
    created DATETIME NOT NULL,
    author VARCHAR(10) NOT NULL,
    ip INT(11) UNSIGNED NOT NULL,
    modified DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    PRIMARY KEY(id));
    
    SHOW TABLES;
    DESC post;
    INSERT INTO post (title,description,created,author,ip) VALUES('test','hello',NOW(),'user',INET_ATON('1.1.1.1'));
    SELECT * FROM post;
    
